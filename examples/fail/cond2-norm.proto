#| Multi-line comments |#
# Single line comments

# We declare a shared location `x`
shared x;

# A normalized example shows no problems

const local tid, global t where distinct [tid] ;

if (t > 3) {
  if (t > 2) {
    rw x[tid];
    sync;
    rw x[tid + 1];
    sync;
    rw x[tid + 2];
  } else {
    rw x[tid];
    rw x[tid + 1];
    sync;
    rw x[tid + 2];
  }
} else {
  if (t > 2) {
    rw x[tid];
    sync;
    rw x[tid + 1];
    rw x[tid + 2];
  } else {
    rw x[tid];
    rw x[tid + 1];
    rw x[tid + 2];
  }
}