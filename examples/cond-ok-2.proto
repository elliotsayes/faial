#|

This is a soundness problem.
A conditional barrier only synchronizes the accesses when t > 2.
This example never races because the second access only appears when the
barrier happens.

|#

shared x;

const local tid, global t where distinct [tid] ;

if (t > 2) {
  rw x[tid];
}

if (t > 2) {
    sync;
}

rw x[tid + 1];
