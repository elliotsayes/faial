(begin
  (loc x (ro (* idx $tid) 999 true))
  (loc x (rw $tid 1 true))
  (loop (range i 999)
    (begin
      sync
      (loc tempBuffer (rw $tid 1 (= (mod $tid (* i 2)) 0)))
    )
  )
  (loc tempBuffer (ro 0 1 (= idx $tid)))
)
