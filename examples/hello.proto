(begin
  (loc x (rw tid true))
  sync
  (loc x (rw (+ idx 1) (range idx 1000) (= tid 0) ) )
  (loc x (rw tid (= tid 0)))
  (loc x (ro idx (range idx tid) true))
)
